// Generated by CoffeeScript 1.3.1

window.ResultsView = Backbone.View.extend({
  initialize: function() {
    var time, timetype;
    this.template = _.template(tpl.get('results'));
    this.params = {
      from: getUrlParam("from"),
      to: getUrlParam("to")
    };
    time = getUrlParam("time");
    timetype = getUrlParam("timetype");
    if (time) {
      this.params.time = time;
    }
    if (timetype) {
      this.params.timetype = timetype;
    }
    return this.model = void 0;
  },
  render: function() {
    var _this = this;
    $(this.el).html(this.template());
    console.log($(this.el).find("#routelist"));
    Reittiopas.route(this.params, function(results) {
      _this.model = results;
      _.each(results, function(result, index) {
        var item;
        item = new ResultsViewItem({
          model: result[0],
          index: index
        }).render().el;
        return $(_this.el).find("#routelist").append(item);
      });
      return $(_this.el).find("#routelist").listview('refresh');
    });
    return this;
  }
});

window.ResultsViewItem = Backbone.View.extend({
  tagName: "li",
  events: {
    "click a": "ping"
  },
  ping: function() {
    return console.log(this.model);
  },
  initialize: function() {
    return this.template = _.template(tpl.get('result-item'));
  },
  render: function() {
    $(this.el).html(this.template({
      route: this.model,
      index: this.options.index
    }));
    return this;
  }
});
